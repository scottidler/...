lookups:
  region:
    prod|apps: us-east-1
    staging|test|dev|ops: us-west-2
    ignore-ptns: '.git|__*|tf|.venv|.mypy_cache|target|incremental|node_modules'

aliases:

  # ========================================
  # TYPO CORRECTIONS
  # ========================================

  sud|suod|soud: sudo
  vim: nvim
  svim: sudo nvim
  vmi|emacs: vim
  rtx: mise
  cd..: cd ..
  cd../: cd ..
  carog: cargo
  authros: authors

  # ========================================
  # GLOBAL ALIASES - Pipes
  # ========================================

  '|c':
    value: '| xclip -sel clip'
    global: true
  '|C':
    value: '| column'
    global: true
  'p|':
    value: 'xclip -sel clip -o |'
    global: true
  '|b':
    value: '| bash'
    global: true
  '|g':
    value: '| grep'
    global: true
  '|gi':
    value: '| grep -i'
    global: true
  '|gv':
    value: '| grep -v'
    global: true
  '|g^':
    value: '| grep ^'
    global: true
    space: false
  '|s':
    value: '| sort'
    global: true
  '|u':
    value: '| sort -u'
    global: true
  '|wc':
    value: '| wc -l'
    global: true
  '|l':
    value: '| less -r'
    global: true
  '|h':
    value: '| head -10'
    global: true
  '|t':
    value: '| tail -10'
    global: true
  '|tf':
    value: '| tail -f'
    global: true
  '|b64':
    value: '| base64'
    global: true
  '|b64d':
    value: '| base64 -d'
    global: true
  '|x':
    value: "| xargs -I% bash -c 'echo %; tab2 '"
    global: true

  # ========================================
  # GLOBAL ALIASES - Redirects
  # ========================================

  e2o|comb:
    value: '2>&1'
    global: true
  tee2files:
    value: '> >(tee -a stdout.log) 2> >(tee -a stderr.log >&2)'
    global: true

  # ========================================
  # GLOBAL ALIASES - Environment
  # ========================================

  LL:
    value: 'LOG_LEVEL='
    space: false
    global: true
  RBT:
    value: RUST_BACKTRACE=1
    global: true
  RL:
    value: RUST_LOG=debug
    global: true

  # ========================================
  # GLOBAL ALIASES - Rust Cross-compile
  # ========================================

  target-windows:
    value: --target x86_64-pc-windows-gnu
    global: true

  # ========================================
  # CLIPBOARD
  # ========================================

  clipboard: xclip -sel clip
  pb-copy:
    value: xclip -sel clip
    global: true
  pb-paste: xclip -sel clip -o
  P: cat ~/prompt | xclip -sel clip

  # ========================================
  # NAVIGATION / DIRECTORIES
  # ========================================

  docs: cd ~/Documents
  down: cd ~/Downloads
  pics: cd ~/Pictures
  vids: cd ~/Videos
  cp-cd: mkdir -p $2 && cp $1 $2 && cd $(toplevel $2)
  mv-cd: mkdir -p $2 && mv $1 $2 && cd $(toplevel $2)
  mkdir-cd: mkdir -p $1 && cd $1
  mkdir: mkdir -p
  cdr: '$(git rev-parse 2>/dev/null) && cd $(git rev-parse --show-toplevel)'
  cdpr: '$(git rev-parse) && {cd ../; cd $(git rev-parse --show-toplevel)}'
  cdp: '$(git rev-parse) && cd $(git rev-parse --show-toplevel) && cd ../'

  # ========================================
  # FILE OPERATIONS
  # ========================================

  bak: mv $1 $1.bak
  sav: cp $1 $1.sav
  backup: tar --exclude='**/*[Cc]ache*' -czvf $1-backup.tar.gz $1
  tarlist: tar ztvf
  sorted: bat -p $1 | sort -u > $1.new; mv $1.new $1

  # ========================================
  # PERMISSIONS
  # ========================================

  mine: sudo chown -R $USER:$USER
  yours: sudo chown -R root:root
  ours: sudo chmod -R 777
  +x: sudo chmod +x

  # ========================================
  # SEARCH
  # ========================================

  /: rg
  //: rg --hidden

  # ========================================
  # LINUX / SYSTEM
  # ========================================

  dmesg: sudo dmesg
  fix-dns: sudo systemd-resolve --flush-caches
  reboot-sound: pulseaudio -k && sudo alsa force-reload
  os-info: 'echo "$(lsb_release -is)-$(lsb_release -rs)_x$(getconf LONG_BIT)($(lsb_release -cs))"'
  hn: hostname
  psgrep: 'ps aux | grep -v grep | grep'
  kernel: uname -sr
  mem: ps -eo comm,rss --no-headers | awk '{a[$$1]+=$$2} END {for (i in a) printf "%-30s %8.2f GiB\n", i, a[i]/1024/1024}' | sort -nr -k2 | head -15

  # ========================================
  # NETWORKING
  # ========================================

  # ping
  ping-1s|ping-cloudflare: ping 1.1.1.1
  ping-8s: ping 8.8.8.8
  ping-9s: ping 9.9.9.9
  ping-google: ping 142.251.33.110
  ping-google-v6: ping 2607:f8b0:400a:80b::200e
  ping10:
    value: ping 10.10.10.
    space: false

  # ip addresses
  ip-lan: 'ip addr show |grep "inet " |grep -v 127.0.0.1 |head -1 |cut -d" " -f6 |cut -d/ -f1'
  ip-pub|ip-web: curl ifconfig.me

  # dns
  ds: dig +short
  tr: traceroute

  # nordvpn
  nv: nordvpn
  nvl: nordvpn login
  nvc: nordvpn connect
  nvd: nordvpn disconnect
  nvs: nordvpn status

  # ========================================
  # SSH
  # ========================================

  home|desk: ssh desk.lan
  work|lappy: ssh ltl-7007.lan
  xps: ssh saidler@xps.lan

  # ========================================
  # CURL / HTTP
  # ========================================

  clh:
    value: 'curl localhost:'
    space: false
  headers-only: curl -sSL -D - $1 -o /dev/null
  curl-follow: curl $1 -gkLs -o /dev/null -v 2>&1|grep -e '^< HTTP' -e '[L|l]ocation:'
  url-effective: curl -Ls -o /dev/null -w %{url_effective} $1

  # ========================================
  # PACKAGE MANAGEMENT
  # ========================================

  # apt
  apt-up|au: |
    sudo apt-get update && \
    sudo apt-get full-upgrade -y && \
    sudo apt-get autoremove -y

  # pip
  pip-up|pu: |
    python3 -m pip install -U pip &&
    python3 -m pip list --outdated |
    cut -d' ' -f1 |
    grep -vxFf ~/.distutils.pkgs |
    xargs -n1 sudo -H python3 -m pip install -U

  # nix
  nb: nix-build
  nrs: sudo nix-rebuild switch

  # ========================================
  # TOOLS - eza (ls replacement)
  # ========================================

  ls: eza
  ll: eza -alFo
  la: eza -lao
  lah: eza -halo --git
  ltr: eza -lro -sold
  T: eza --tree -a --long --ignore-glob='.git|__*|tf|.venv|*_cache|target|incremental|node_modules'

  # ========================================
  # TOOLS - General
  # ========================================

  calc: fend
  cat: bat -p
  cl: clear
  e2d: date -d @$1
  email: himalaya
  ex: exercism
  pa: pulseaudio
  pm: pulsemixer
  co: cat .github/CODEOWNERS
  SS: starship
  xdo: xdotool
  st: speedtest-rs
  wiki: wiki-tui "$@"
  cookie: cookiecutter
  scaf: scaffold
  afields: awk -v N=$1 '{sep=""; for (i=N; i<=NF; i++) {printf("%s%s",sep,$i); sep=OFS}; printf("\n")}'
  par: parallel
  acre-side: 'awk "BEGIN { print sqrt($1 * 43560) }"'
  ntws|nuke-trailing-whitespace: sed -i 's/[[:space:]]*$//' $1
  pp: prepend $1 $2
  pp-rust: prepend "#![cfg_attr(debug_assertions, allow(unused_imports, unused_variables, unused_mut, dead_code))]" $1

  # ========================================
  # MEDIA
  # ========================================

  extract: ffmpeg -i $1 -vsync 2 '$1_%04d.png'
  mi: mediainfo
  cinema: asciinema

  # ========================================
  # CONFIG EDITING
  # ========================================

  akas: editor ~/.config/aka/aka.yml; . ~/.zshrc
  bashrc: editor ~/.bashrc; . ~/.bashrc
  zshrc: editor ~/.zshrc; . ~/.zshrc
  aliases: editor ~/.shell-aliases; . ~/.zshrc
  exports: editor ~/.shell-exports; . ~/.zshrc
  functions: editor ~/.shell-functions; . ~/.zshrc

  # ========================================
  # WHICH COMBOS
  # ========================================

  follow-which|fw: follow $(which $1)
  cat-which|cw: 'WHICHD=(); for ARG in $(echo "$@"); do WHICHD+=("$(which $ARG)") done; bat "${WHICHD[@]}"'
  vim-which|vw: 'WHICHD=(); for ARG in $(echo "$@"); do WHICHD+=("$(which $ARG)") done; vim "${WHICHD[@]}"'
  printr:
    value: print -r -- =$1
    space: false

  # ========================================
  # PERSONAL PROJECTS - aka
  # ========================================

  ah: aka --help
  al: aka ls
  ad: aka daemon
  adr: aka daemon --restart
  aq: aka query
  af: aka freq
  afa: aka freq --all

  # ========================================
  # PERSONAL PROJECTS - gx
  # ========================================

  gxh: gx --help
  gxs: gx status
  gxc: gx clone
  gxco: gx checkout

  # ========================================
  # PERSONAL PROJECTS - kat
  # ========================================

  jat: kat json
  Jat: kat json | xclip -sel clip
  jvat: kat java
  Jvat: kat java | xclip -sel clip
  rat: kat rust
  Rat: kat rust | xclip -sel clip
  pat: kat python
  Pat: kat python | xclip -sel clip
  yat: kat yaml
  Yat: kat yaml | xclip -sel clip
  tat: kat toml
  Tat: kat toml | xclip -sel clip
  wat: kat web
  Wat: kat web | xclip -sel clip
  ptns: kat ptns -i $1 | xclip -sel clip

  # ========================================
  # PERSONAL PROJECTS - manifest
  # ========================================

  m: manifest

  # ========================================
  # PERSONAL PROJECTS - otto
  # ========================================

  o: otto
  oh: otto --help
  ov: otto --version
  # built-ins
  oC: otto Clean
  oV: otto Convert
  og: otto Graph
  oH: otto History
  ost: otto Stats
  ou: otto Upgrade
  # common
  oa: otto all
  ot: otto test
  oc: otto cov
  oci: otto ci

  # ========================================
  # PERSONAL PROJECTS - rkvr (rmrf-rs)
  # ========================================

  bkup: rkvr bkup
  rmrf: rkvr rmrf
  rcvr: rkvr rcvr
  ls-bkup: rkvr ls-bkup
  ls-rmrf: rkvr ls-rmrf
  bkup-rmrf: rkvr bkup-rmrf

  # ========================================
  # PERSONAL PROJECTS - whitespace
  # ========================================

  ws|whitespace: whitespace -r

  # ========================================
  # PERSONAL PROJECTS - workweek / readtime
  # ========================================

  ww: workweek
  rt: readtime

  # ========================================
  # WORK - Tatari
  # ========================================

  ave:
    value: aws-vault exec --
    global: true
  ttv:
    value: tatari-tv
    global: true
  ls-tatari|ls-ttv: ls-github-repos tatari-tv
  av: aws-vault exec -d 12h prod --
  aws-id: '$av aws sts get-caller-identity | jq -r .Account'
  aws-env: 'env | grep AWS_'
  update-ctx|update-context: $av aws eks --region lookup:region[$1] update-kubeconfig --name $1 --alias $1 --role-arn arn:aws:iam::878256633362:role/eks-$1-admin
  debug-git: GIT_SSH_COMMAND="ssh -i $WORK_SSH_PUB_KEY -vvv"

  # ========================================
  # CARGO (Rust)
  # ========================================

  ca: cargo add
  cad: cargo add --dev
  ci: cargo init
  cip: cargo install --path . --locked
  cf: cargo fmt
  cc: cargo clippy
  ccf: cargo clippy --fix -- -W clippy::pedantic -W clippy::nursery -W clippy::unwrap_used -W clippy::expect_used
  cfc: cargo fmt && cargo clippy
  cb: cargo build
  cbr: cargo build --release
  ct: cargo test
  cr: cargo run -q --
  crd: RUST_LOG=debug cargo run -q --
  crh: cargo run -q -- --help
  crv: cargo run -q -- --version
  car: bat -p Cargo.toml
  csm: bat -p src/main.rs
  vsm: vim src/main.rs
  bump2: cargo release patch --execute --no-publish

  # ========================================
  # DOCKER
  # ========================================

  d: docker
  dc: docker-compose
  di: 'docker images | (read -r; printf "%s\n" "$REPLY"; sort)'
  dps: 'docker ps | (read -r; printf "%s\n" "$REPLY"; sort)'
  dpsa: 'docker ps -a | (read -r; printf "%s\n" "$REPLY"; sort)'
  drm: docker rm
  drmi: docker rmi
  drit: docker run -it --rm
  deit: docker exec -it
  ls-dangling-images: docker images -q --filter "dangling=true"
  rm-stopped-containers: 'docker rm $(docker ps -q -f "status=exited")'
  rm-dangling-images: 'docker rmi $(docker images -q --filter "dangling=true")'

  # ========================================
  # GIT
  # ========================================

  g: git
  ga: git add
  gb: git branch
  gm: git merge
  gc:
    value: 'git commit -m"'
    space: false
  gcm: "git checkout $(git rev-parse --abbrev-ref origin/HEAD 2>/dev/null | sed 's@^origin/@@')"
  gd: git diff
  gD: git describe
  gp: git pull
  gP: git push
  gpo: 'git push -u origin $(git symbolic-ref --short -q HEAD)'
  gpot: 'git push -u origin $(git symbolic-ref --short -q HEAD) --tags'
  gpof: 'git push -u origin $(git symbolic-ref --short -q HEAD) --force-with-lease'
  gs: git status --short
  gco: git checkout
  gcob: git checkout -b
  grp: git rev-parse
  gsh: git show
  grh: git reset --hard
  grhh: git reset --hard HEAD
  grph: git rev-parse HEAD
  grim: git rebase -i main
  tags: git tag -l
  gl: git log -$1
  reporoot: git rev-parse --show-toplevel
  ls-remote: git ls-remote
  ls-remote-heads: git ls-remote | grep refs/heads/
  ls-remote-branch: 'git ls-remote | grep refs/heads/$(git rev-parse --abbrev-ref HEAD)'
  ls-remote-tag: 'git ls-remote | grep refs/tags/$(git describe --abbrev=0)'
  ls-remote-tags: git ls-remote | grep refs/tags/
  set-upstream: 'git branch --set-upstream-to=origin/$(git rev-parse --abbrev-ref HEAD) $(git rev-parse --abbrev-ref HEAD)'
  prune: git remote prune origin
  unstage: git reset HEAD
  clean: git clean -xfd
  describe: 'git describe --match "v*" --abbrev=7'
  rm-tag: git tag -d $1; git push origin :$1
  db: delete-branch
  authors: git shortlog -s -n --all --no-merges
  refresh: find . -maxdepth 2 -type d -name ".git" | xargs -n1 dirname | parallel -j $(nproc) "cd {} && git pull"

  # ========================================
  # GH (GitHub CLI)
  # ========================================

  ghpr: gh pr create -t "$(git branch --show-current)" -a "@me"

  # ========================================
  # KUBECTL (k8s)
  # ========================================

  k: kubectl
  ka: kubectl apply -f
  kg: kubectl get
  kga: kubectl get all
  kgA: kubectl get all,cert,order,secret,ingress,hr
  kgC: kubectl get crd
  kgp: kubectl get pod
  kgs: kubectl get svc
  kgS: kubectl get secret
  kgd: kubectl get deployment
  kgc: kubectl get certificate
  kgh: kubectl get helmrelease
  kgn: kubectl get namespace
  kgN: kubectl get networkpolicy
  kd: kubectl describe
  kdC: kubectl describe crd
  kdp: kubectl describe pod
  kds: kubectl describe svc
  kdS: kubectl describe secret
  kdd: kubectl describe deployment
  kdc: kubectl describe certificate
  kdv: kubectl describe ingress.voyager.appscode.com
  kD: kubectl delete
  kDC: kubectl delete crd
  kDp: kubectl delete pod
  kDs: kubectl delete svc
  kDS: kubectl delete secret
  kDd: kubectl delete deployment
  kDn: kubectl delete namespace
  kv: kubectl version
  kl: kubectl logs
  ns:
    value: --namespace
    global: true
  oy:
    value: -o yaml
    global: true
  ctx|context: kubectl config current-context
  ctxs|contexts: kubectl config get-contexts
  use-ctx|use-context: kubectl config use-context $1

  # ========================================
  # PYTHON
  # ========================================

  ipy: ipython
  pip-search: pip_search
  pt: pytest

  # ========================================
  # TERRAFORM
  # ========================================

  tf: terraform
  tfp: terraform plan
  tfa: terraform apply
  tf-fmt: terraform fmt -write=true -diff=true -recursive
  tfpt-gh: terraform plan --target 'github_repository.repos["$1"]'
  tfv: tfvar

  # ========================================
  # YAML
  # ========================================

  YL: yamllint
  yml-lint: yq -i . $1

  # ========================================
  # QUARTZ
  # ========================================

  qs: npx quartz sync
  qbs: npx quartz build --serve

  # ========================================
  # PDF
  # ========================================

  pdf2md: |
    filename="${1%.pdf}"
    pdftotext -layout "$filename.pdf" - | pandoc -f markdown -t markdown -o "$filename.md"

  # ========================================
  # UPDATE + SHUTDOWN/REBOOT
  # ========================================

  ureboot: 'update && reboot'
  ushutdown: 'update && shutdown'

  # ========================================
  # ONE-OFFS (review periodically)
  # ========================================

  # slack gpg key for apt
  slack-gpg: sudo cp ~/Documents/slack.list /etc/apt/sources.list.d/slack.list

  # spanish pdf extraction - consider moving to a script
  xtract: PDF="$1"; ~/Documents/spanish/cronicas/extract.py $PDF; bat "${PDF%.pdf}.yml"
